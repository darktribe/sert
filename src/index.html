<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sert Editor</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- =====================================================
             ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼
             ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã€ç·¨é›†æ“ä½œã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æä¾›
             ===================================================== -->
        <div class="menu-bar">
            <!-- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
            <div class="menu-item" onclick="toggleMenu('file-menu')">
                ãƒ•ã‚¡ã‚¤ãƒ«
                <div class="dropdown-menu" id="file-menu">
                    <div class="menu-option" onclick="newFile()">æ–°è¦ä½œæˆ</div>
                    <div class="menu-option" onclick="openFile()">é–‹ã</div>
                    <div class="menu-option" onclick="console.log('ğŸ’¾ Save menu clicked'); if(typeof saveFile === 'function') { saveFile(); } else { console.error('âŒ saveFile not found!', typeof saveFile); }">ä¸Šæ›¸ãä¿å­˜</div>
                    <div class="menu-option" onclick="saveAsFile()">åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜</div>
                    <div class="menu-separator"></div>
                    <div class="menu-option" onclick="exitApp()">çµ‚äº†</div>
                </div>
            </div>
            
            <!-- ç·¨é›†ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
            <div class="menu-item" onclick="toggleMenu('edit-menu')">
                ç·¨é›†
                <div class="dropdown-menu" id="edit-menu">
                    <div class="menu-option" onclick="undo()">å…ƒã«æˆ»ã™</div>
                    <div class="menu-option" onclick="redo()">ã‚„ã‚Šç›´ã—</div>
                    <div class="menu-separator"></div>
                    <div class="menu-option" onclick="cut()">åˆ‡ã‚Šå–ã‚Š</div>
                    <div class="menu-option" onclick="copy()">ã‚³ãƒ”ãƒ¼</div>
                    <div class="menu-option" onclick="paste()">è²¼ã‚Šä»˜ã‘</div>
                    <div class="menu-separator"></div>
                    <div class="menu-option" onclick="selectAll()">ã™ã¹ã¦é¸æŠ</div>
                </div>
            </div>
        </div>

        <!-- =====================================================
             ã‚¨ãƒ‡ã‚£ã‚¿ã‚¨ãƒªã‚¢
             è¡Œç•ªå·ã¨ãƒ†ã‚­ã‚¹ãƒˆç·¨é›†é ˜åŸŸã‚’å«ã‚€
             ===================================================== -->
        <div class="editor-container">
            <!-- è¡Œç•ªå·è¡¨ç¤º -->
            <div class="line-numbers" id="line-numbers">1</div>
            
            <!-- ãƒ¡ã‚¤ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ -->
            <textarea 
                class="editor-textarea" 
                id="editor" 
                placeholder="ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."
                spellcheck="false"
            ></textarea>
        </div>

        <!-- =====================================================
             ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼
             ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã¨æ–‡å­—æ•°ã‚’è¡¨ç¤º
             ===================================================== -->
             <div class="status-bar">
                <span id="cursor-position">è¡Œ: 1, åˆ—: 1</span>
                <span id="file-encoding">UTF-8</span>
                <span id="char-count">ç·æ–‡å­—æ•°: 0</span>
            </div>
    </div>

    <!-- =====================================================
         JavaScriptåˆæœŸåŒ–
         ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç›´æ¥èª­ã¿è¾¼ã¿ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã‚’ç¢ºå®Ÿã«ç™»éŒ²
         ===================================================== -->
    <script type="module" src="main.js"></script>
    
    <!-- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ãƒã‚§ãƒƒã‚¯ -->
    <script>
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸæ™‚ã®ãƒ‡ãƒãƒƒã‚°é–¢æ•°
        window.debugSave = function() {
            console.log('ğŸ” Debug: saveFile function check');
            console.log('typeof window.saveFile:', typeof window.saveFile);
            if (typeof window.saveFile === 'function') {
                console.log('âœ… saveFile function found, calling it...');
                window.saveFile();
            } else {
                console.error('âŒ saveFile function not found!');
                console.log('Available window functions:', Object.keys(window).filter(key => key.includes('File')));
            }
        };
        
        // DOMContentLoadedå¾Œã«ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã®å­˜åœ¨ç¢ºèª
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                console.log('ğŸ” Final global function check:');
                console.log('window.saveFile:', typeof window.saveFile);
                console.log('window.newFile:', typeof window.newFile);
                console.log('window.openFile:', typeof window.openFile);
                
                if (typeof window.saveFile !== 'function') {
                    console.error('âŒ Critical: saveFile not registered as global function!');
                }
            }, 2000);
        });
    </script>
</body>
</html>